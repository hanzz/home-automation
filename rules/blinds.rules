rule "Automatic GF blinds up on Sunrise, but not before 7:00."
when
    Channel 'astro:sun:home_blinds_control:rise#event' triggered START
then
    if (AutoBlindsEnabled.state == ON && BlindsGFAll.state != 0) {
        BlindsGFAll.sendCommand(UP)
    }
end


rule "Automatic all blinds down on Sunset + 20 minutes."
when
    Channel 'astro:sun:home_blinds_control:set#event' triggered START
then
    if (AutoBlindsEnabled.state == ON) {
        BlindsGFAll.sendCommand(DOWN)
        BlindsFFAll.sendCommand(DOWN)
    }
end


rule "On sunrise, move GF blinds up if breakfast started."
when
    Channel 'astro:sun:home:rise#event' triggered START
then
    if (AutoBlindsEnabled.state == ON && Breakfast.state == ON && BlindsGFAll.state != 0) {
        BlindsGFAll.sendCommand(UP)
    }
end


rule "On breakfast start, move GF blinds up if sunrise already started."
when
    Item Breakfast changed to ON
then
    val sunrise = new DateTime(SunriseTime.state.toString)
    if (AutoBlindsEnabled.state == ON && now.isAfter(sunrise) && BlindsGFAll.state != 0) {
        BlindsGFAll.sendCommand(UP)
    }
end


rule "Everyday on 8:00, move the blinds in FF up."
when
    Time cron "0 0 8 1/1 * ? *"
then
    if (AutoBlindsEnabled.state == ON) {
        BlindsFFAll.sendCommand(UP)
    }
end

rule "Ground room blinds down if sun is shining."
when
    Item WeatherStationSolarRadiation changed
then
    if (WeatherStationSolarRadiation.state > 30 && BlindGroundRoom.state != 100) {
        BlindGroundRoom.sendCommand(DOWN)
        Thread::sleep(42)
        sendHttpGetRequest("http://10.0.0.110:8090?blind_name=GROUND_ROOM&cmd=UP_A_BIT")
    }
end
